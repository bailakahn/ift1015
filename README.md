# labyrinth

To run: <a href="http://codeboot.org/query.cgi?REPLAY=QENsYWJ5cmludGguanNAMC8vIEF1dGhvcjogQWxleGFuZHJlIEJyaWxoYW50ZUBOQE4vKiBQcmludHMgb3V0IGEgbGFieXJpbnRoIHdpdGggYSBzaW5nbGUgc29sdXRpb24gdXNpbmcgdHVydGxlIGdyYXBoaWNzLiAqL0BOQE52YXIgbGFieSA9IGZ1bmN0aW9uKG54LCBueSwgc3RlcCkge0BOICAgIHZhciBoV2FsbHMgPSBpb3RhKG54K255Km54KTtATiAgICB2YXIgdldhbGxzID0gaW90YSgobngrMSkqbnkpO0BOICAgIHZhciB4ID0gKE1hdGguZmxvb3IobngqTWF0aC5yYW5kb20oKSkpO0BOICAgIHZhciB5ID0gKE1hdGguZmxvb3IobnkqTWF0aC5yYW5kb20oKSkpO0BOICAgIHZhciBjYXZlID0gW3greSpueF07QE4gICAgdmFyIGZyb250ID0gbmVpZ2hib3JzICh4LCB5LCBueCwgbnkpO0BOICAgIHJlbW92ZShoV2FsbHMsIDApO0BOICAgIHJlbW92ZShoV2FsbHMsIChueCtueSpueCktMSk7QE4gICAgd2hpbGUgKGNhdmUubGVuZ3RoIDwgbngqbnkpIHtATiAgICAgICAgdmFyIGNlbGwgPSBmcm9udFtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqZnJvbnQubGVuZ3RoKV07QE4gICAgICAgIHZhciB4Q29vcmRpbmF0ZSA9IGNlbGwlbng7QE4gICAgICAgIHZhciB5Q29vcmRpbmF0ZSA9IChjZWxsLXhDb29yZGluYXRlKS9ueDtATiAgICAgICAgdmFyIGNlbGxOZWlnaHJib3JzID0gbmVpZ2hib3JzKHhDb29yZGluYXRlLCB5Q29vcmRpbmF0ZSwgbngsIG55KTtATiAgICAgICAgdmFyIHRlbXAgPSBbXTtATiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjZWxsTmVpZ2hyYm9ycy5sZW5ndGg7IGkrKykge0BOICAgICAgICAgICAgaWYgKGNvbnRhaW5zKGNhdmUsIGNlbGxOZWlnaHJib3JzW2ldKSkge0BOICAgICAgICAgICAgICAgIHRlbXAucHVzaChjZWxsTmVpZ2hyYm9yc1tpXSk7QE4gICAgICAgICAgICB9IEBOICAgICAgICAgICAgZWxzZSB7IEBOICAgICAgICAgICAgICAgIChmcm9udCA9IGFkZChmcm9udCwgY2VsbE5laWdocmJvcnNbaV0pKTtATiAgICAgICAgICAgIH1ATiAgICAgICAgfUBOICAgICAgICB2YXIgbmV3Q2VsbCA9IHRlbXBbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnRlbXAubGVuZ3RoKV07QE4gICAgICAgIGlmIChjZWxsLW5ld0NlbGwgPT0gMSkge0BOICAgICAgICAgICB2V2FsbHMgPSByZW1vdmUodldhbGxzLCB4Q29vcmRpbmF0ZSt5Q29vcmRpbmF0ZSoobngrMSkpO0BOICAgICAgICB9QE4gICAgICAgIGVsc2UgaWYgKGNlbGwtbmV3Q2VsbCA9PSAtMSkge0BOICAgICAgICAgICB2V2FsbHMgPSByZW1vdmUodldhbGxzLCAxK3hDb29yZGluYXRlK3lDb29yZGluYXRlKihueCsxKSk7QE4gICAgICAgIH1ATiAgICAgICAgZWxzZSBpZiAoY2VsbC1uZXdDZWxsPT1ueCkge0BOICAgICAgICAgICBoV2FsbHMgPSByZW1vdmUoaFdhbGxzLCB4Q29vcmRpbmF0ZSt5Q29vcmRpbmF0ZSpueCk7QE4gICAgICAgIH1ATiAgICAgICAgZWxzZSBpZiAoY2VsbC1uZXdDZWxsPT0tbngpIHtATiAgICAgICAgICAgaFdhbGxzID0gcmVtb3ZlKGhXYWxscywgeENvb3JkaW5hdGUrKHlDb29yZGluYXRlKzEpKm54KTtATiAgICAgICAgfUBOICAgICAgICBhZGQoY2F2ZSwgY2VsbCk7QE4gICAgICAgIHJlbW92ZShmcm9udCwgY2VsbCk7QE4gICAgfUBOICAgIGRyYXcoaFdhbGxzLCB2V2FsbHMsIG54LCBueSwgc3RlcCk7QE59O0BOQE52YXIgZHJhdyA9IGZ1bmN0aW9uIChoV2FsbHMsIHZXYWxscywgbngsIG55LCBzdGVwKSB7QE4gICAgcHUoKTtATiAgICBydCg5MCk7QE4gICAgYmsobngqc3RlcC8yKTtATiAgICBsdCg5MCk7QE4gICAgZmQobnkqc3RlcC8yKTtATiAgICBydCg5MCk7QE4gICAgdmFyIGggPSAwO0BOICAgIHZhciB2ID0gKChueCsxKSpueSktMS1ueDtATiAgICBmb3IgKHZhciBpID0gMDsgaSA8PSBueTsgaSsrKSB7QE4gICAgICAgIGZvciAodmFyIGo9MDsgaiA8IG54OyBqKyspIHsgQE4gICAgICAgICAgICBpZiAoY29udGFpbnMoaFdhbGxzLCBoKSkgeyBATiAgICAgICAgICAgICAgICBwZCgpO0BOICAgICAgICAgICAgICAgIGZkKHN0ZXApOyBATiAgICAgICAgICAgICAgICBoKys7IEBOICAgICAgICAgICAgfUBOICAgICAgICAgICAgZWxzZSB7IEBOICAgICAgICAgICAgICAgIHB1KCk7IEBOICAgICAgICAgICAgICAgIGZkKHN0ZXApO0BOICAgICAgICAgICAgICAgIHBkKHN0ZXApO0BOICAgICAgICAgICAgICAgIGgrKzsgQE4gICAgICAgICAgICB9IEBOICAgICAgICB9QE4gICAgICAgIHB1KCk7QE4gICAgICAgIGJrKG54KnN0ZXApO0BOICAgICAgICBydCg5MCk7QE4gICAgICAgIGZkKHN0ZXApO0BOICAgICAgICBsdCg5MCk7IEBOICAgIH0gQE4gICAgbHQoOTApO0BOICAgIGZkKHN0ZXApO0BOICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IG54OyBpKyspIHtATiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBueTsgaisrKSB7IEBOICAgICAgICAgICAgaWYgKGNvbnRhaW5zKHZXYWxscywgdikpIHsgQE4gICAgICAgICAgICAgICAgcGQoKTtATiAgICAgICAgICAgICAgICBmZChzdGVwKTsgQE4gICAgICAgICAgICAgICAgdiAtPSAobngrMSk7IEBOICAgICAgICAgICAgfSBATiAgICAgICAgICAgIGVsc2UgeyBATiAgICAgICAgICAgICAgICBwdSgpOyBATiAgICAgICAgICAgICAgICBmZChzdGVwKTtATiAgICAgICAgICAgICAgICBwZCgpO0BOICAgICAgICAgICAgICAgIHYgLT0gKG54KzEpOyBATiAgICAgICAgICAgIH0gQE4gICAgICAgIH1ATiAgICAgICAgcHUoKTtATiAgICAgICAgYmsobnkqc3RlcCk7QE4gICAgICAgIHJ0KDkwKTtATiAgICAgICAgZmQoc3RlcCk7QE4gICAgICAgIGx0KDkwKTtATiAgICAgICAgcGQoKTtATiAgICAgICAgdiArPSAobngrMSkqbnkrMTtATiAgICB9QE59O0BOQE52YXIgaW90YSA9IGZ1bmN0aW9uKG4pIHtATiAgICB2YXIgdGFiID0gW107QE4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHtATiAgICAgICAgdGFiLnB1c2goaSk7QE4gICAgfUBOICAgIHJldHVybiB0YWI7QE59O0BOQE52YXIgY29udGFpbnMgPSBmdW5jdGlvbih0YWIsIHgpIHtATiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhYi5sZW5ndGg7IGkrKykge0BOICAgICAgICBpZiAodGFiW2ldID09IHgpIHtATiAgICAgICAgICAgIHJldHVybiB0cnVlO0BOICAgICAgICB9IEBOICAgIH1ATiAgICByZXR1cm4gZmFsc2U7QE59O0BOQE52YXIgYWRkID0gZnVuY3Rpb24odGFiLCB4KSB7QE4gICAgaWYgKGNvbnRhaW5zKHRhYiwgeCkgPT0gZmFsc2UpIHtATiAgICAgICAgdGFiLnB1c2goeCk7QE4gICAgfUBOICAgIHJldHVybiB0YWI7QE59O0BOQE52YXIgcmVtb3ZlID0gZnVuY3Rpb24odGFiLCB4KSB7QE4gICAgaWYgKGNvbnRhaW5zKHRhYiwgeCkgPT0gdHJ1ZSkge0BOICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhYi5sZW5ndGg7IGkrKykge0BOICAgICAgICAgICAgaWYgKHRhYltpXSA9PSB4KSB7IEBOICAgICAgICAgICAgICAgIHRhYi5zcGxpY2UoaSwgMSk7QE4gICAgICAgICAgICB9QE4gICAgICAgIH1ATiAgICB9QE4gICAgcmV0dXJuIHRhYjtATn07QE5ATnZhciBuZWlnaGJvcnMgPSBmdW5jdGlvbih4LCB5LCBueCwgbnkpIHtATiAgICB2YXIgdGVtcDtATiAgICB2YXIgTiA9IHgreSpueDtATiAgICBpZiAoeCA9PSAwICYmIHkgPT0gMCkge0BOICAgICAgICB0ZW1wID0gW04rbngsIE4rMV07QE4gICAgfUBOICAgIGVsc2UgaWYgKHggPT0gMCAmJiAoeSA8PSBueS0yICYmIHkgIT0gMCkpIHtATiAgICAgICAgdGVtcCA9IFtOLW54LCBOK254LCBOKzFdO0BOICAgIH1ATiAgICBlbHNlIGlmICh4ID09IDAgJiYgeSA9PSBueS0xKSB7QE4gICAgICAgIHRlbXAgPSBbTi1ueCwgTisxXTtATiAgICB9QE4gICAgZWxzZSBpZiAoeCA9PSBueC0xICYmIHkgPT0gMCkge0BOICAgICAgICB0ZW1wID0gW04tMSxOK254XTtATiAgICB9QE4gICAgZWxzZSBpZiAoeCA9PSBueC0xICYmIHkgPT0gbnktMSkge0BOICAgICAgICB0ZW1wID0gW04tbngsIE4tMV07QE4gICAgfUBOICAgIGVsc2UgaWYgKHggPT0gbngtMSAmJiAoeSA8PSBueS0yICYmIHkgIT0gMCkpIHtATiAgICAgICAgdGVtcCA9IFtOLW54LCBOLTEsIE4rbnhdO0BOICAgIH1ATiAgICBlbHNlIGlmICh5ID09IG55LTEgJiYgKHggIT0gMCAmJiB4IDw9IG54LTIpKSB7QE4gICAgICAgIHRlbXAgPSBbTi1ueCwgTi0xLCBOKzFdO0BOICAgIH1ATiAgICBlbHNlIGlmICh5ID09IDAgJiYgKHggPD0gbngtMiAmJiB4ICE9IDApKSB7QE4gICAgICAgIHRlbXAgPSBbTi0xLCBOK254LCBOKzFdO0BOICAgIH1ATiAgICBlbHNlIGlmICgoeSAhPSAwICYmIHkgPD0gbnktMikgJiYgKHggIT0gMCAmJiB4IDw9IG54LTIpKSB7QE4gICAgICAgIHRlbXAgPSBbTi1ueCwgTi0xLCBOK254LCBOKzFdO0BOICAgIH1ATiAgICB0ZW1wLnNvcnQoKTtATiAgICByZXR1cm4gdGVtcDtATn07QE5ATmxhYnkoMjAsIDIwLCA1KTtARQ==
">codeBoot.org</a>
